// Code generated by mash-featgen. DO NOT EDIT.

package features

import (
	"context"

	"github.com/mash-protocol/mash-go/pkg/model"
)

// DeviceInfo attribute IDs.
const (
	DeviceInfoAttrDeviceID        uint16 = 1
	DeviceInfoAttrVendorName      uint16 = 2
	DeviceInfoAttrProductName     uint16 = 3
	DeviceInfoAttrSerialNumber    uint16 = 4
	DeviceInfoAttrVendorID        uint16 = 5
	DeviceInfoAttrProductID       uint16 = 6
	DeviceInfoAttrSoftwareVersion uint16 = 10
	DeviceInfoAttrHardwareVersion uint16 = 11
	DeviceInfoAttrSpecVersion     uint16 = 12
	DeviceInfoAttrEndpoints       uint16 = 20
	DeviceInfoAttrUseCases        uint16 = 21
	DeviceInfoAttrLocation        uint16 = 30
	DeviceInfoAttrLabel           uint16 = 31
)

// DeviceInfoFeatureRevision is the current revision of the DeviceInfo feature.
const DeviceInfoFeatureRevision uint16 = 1

// DeviceInfo wraps a Feature with DeviceInfo-specific functionality.
// Device identification, versioning, and endpoint structure.
type DeviceInfo struct {
	*model.Feature
	onRemoveZone func(ctx context.Context, req RemoveZoneRequest) (RemoveZoneResponse, error)
}

// NewDeviceInfo creates a new DeviceInfo feature.
func NewDeviceInfo() *DeviceInfo {
	f := model.NewFeature(model.FeatureDeviceInfo, DeviceInfoFeatureRevision)

	f.AddAttribute(model.NewAttribute(&model.AttributeMetadata{
		ID:          DeviceInfoAttrDeviceID,
		Name:        "deviceId",
		Type:        model.DataTypeString,
		Access:      model.AccessReadOnly,
		Description: "Globally unique device identifier",
	}))

	f.AddAttribute(model.NewAttribute(&model.AttributeMetadata{
		ID:          DeviceInfoAttrVendorName,
		Name:        "vendorName",
		Type:        model.DataTypeString,
		Access:      model.AccessReadOnly,
		Description: "Manufacturer name",
	}))

	f.AddAttribute(model.NewAttribute(&model.AttributeMetadata{
		ID:          DeviceInfoAttrProductName,
		Name:        "productName",
		Type:        model.DataTypeString,
		Access:      model.AccessReadOnly,
		Description: "Product name",
	}))

	f.AddAttribute(model.NewAttribute(&model.AttributeMetadata{
		ID:          DeviceInfoAttrSerialNumber,
		Name:        "serialNumber",
		Type:        model.DataTypeString,
		Access:      model.AccessReadOnly,
		Description: "Device serial number",
	}))

	f.AddAttribute(model.NewAttribute(&model.AttributeMetadata{
		ID:          DeviceInfoAttrVendorID,
		Name:        "vendorId",
		Type:        model.DataTypeUint32,
		Access:      model.AccessReadOnly,
		Nullable:    true,
		Description: "IANA Private Enterprise Number",
	}))

	f.AddAttribute(model.NewAttribute(&model.AttributeMetadata{
		ID:          DeviceInfoAttrProductID,
		Name:        "productId",
		Type:        model.DataTypeUint16,
		Access:      model.AccessReadOnly,
		Nullable:    true,
		Description: "Vendor's product ID",
	}))

	f.AddAttribute(model.NewAttribute(&model.AttributeMetadata{
		ID:          DeviceInfoAttrSoftwareVersion,
		Name:        "softwareVersion",
		Type:        model.DataTypeString,
		Access:      model.AccessReadOnly,
		Description: "Firmware/software version",
	}))

	f.AddAttribute(model.NewAttribute(&model.AttributeMetadata{
		ID:          DeviceInfoAttrHardwareVersion,
		Name:        "hardwareVersion",
		Type:        model.DataTypeString,
		Access:      model.AccessReadOnly,
		Nullable:    true,
		Description: "Hardware revision",
	}))

	f.AddAttribute(model.NewAttribute(&model.AttributeMetadata{
		ID:          DeviceInfoAttrSpecVersion,
		Name:        "specVersion",
		Type:        model.DataTypeString,
		Access:      model.AccessReadOnly,
		Default:     "1.0",
		Description: "MASH specification version",
	}))

	f.AddAttribute(model.NewAttribute(&model.AttributeMetadata{
		ID:          DeviceInfoAttrEndpoints,
		Name:        "endpoints",
		Type:        model.DataTypeArray,
		Access:      model.AccessReadOnly,
		Description: "Complete device endpoint structure",
	}))

	f.AddAttribute(model.NewAttribute(&model.AttributeMetadata{
		ID:          DeviceInfoAttrUseCases,
		Name:        "useCases",
		Type:        model.DataTypeArray,
		Access:      model.AccessReadOnly,
		Description: "Use cases supported by this device",
	}))

	f.AddAttribute(model.NewAttribute(&model.AttributeMetadata{
		ID:          DeviceInfoAttrLocation,
		Name:        "location",
		Type:        model.DataTypeString,
		Access:      model.AccessReadWrite,
		Nullable:    true,
		Description: "Installation location",
	}))

	f.AddAttribute(model.NewAttribute(&model.AttributeMetadata{
		ID:          DeviceInfoAttrLabel,
		Name:        "label",
		Type:        model.DataTypeString,
		Access:      model.AccessReadWrite,
		Nullable:    true,
		Description: "User-assigned name",
	}))

	d := &DeviceInfo{Feature: f}
	d.addCommands()

	return d
}

// DeviceID returns the globally unique device identifier.
func (d *DeviceInfo) DeviceID() string {
	val, _ := d.ReadAttribute(DeviceInfoAttrDeviceID)
	if v, ok := val.(string); ok {
		return v
	}
	return ""
}

// VendorName returns the manufacturer name.
func (d *DeviceInfo) VendorName() string {
	val, _ := d.ReadAttribute(DeviceInfoAttrVendorName)
	if v, ok := val.(string); ok {
		return v
	}
	return ""
}

// ProductName returns the product name.
func (d *DeviceInfo) ProductName() string {
	val, _ := d.ReadAttribute(DeviceInfoAttrProductName)
	if v, ok := val.(string); ok {
		return v
	}
	return ""
}

// SerialNumber returns the device serial number.
func (d *DeviceInfo) SerialNumber() string {
	val, _ := d.ReadAttribute(DeviceInfoAttrSerialNumber)
	if v, ok := val.(string); ok {
		return v
	}
	return ""
}

// VendorID returns the iANA Private Enterprise Number.
func (d *DeviceInfo) VendorID() (uint32, bool) {
	val, err := d.ReadAttribute(DeviceInfoAttrVendorID)
	if err != nil || val == nil {
		return 0, false
	}
	if v, ok := val.(uint32); ok {
		return v, true
	}
	return 0, false
}

// ProductID returns the vendor's product ID.
func (d *DeviceInfo) ProductID() (uint16, bool) {
	val, err := d.ReadAttribute(DeviceInfoAttrProductID)
	if err != nil || val == nil {
		return 0, false
	}
	if v, ok := val.(uint16); ok {
		return v, true
	}
	return 0, false
}

// SoftwareVersion returns the firmware/software version.
func (d *DeviceInfo) SoftwareVersion() string {
	val, _ := d.ReadAttribute(DeviceInfoAttrSoftwareVersion)
	if v, ok := val.(string); ok {
		return v
	}
	return ""
}

// HardwareVersion returns the hardware revision.
func (d *DeviceInfo) HardwareVersion() (string, bool) {
	val, err := d.ReadAttribute(DeviceInfoAttrHardwareVersion)
	if err != nil || val == nil {
		return "", false
	}
	if v, ok := val.(string); ok {
		return v, true
	}
	return "", false
}

// SpecVersion returns the mASH specification version.
func (d *DeviceInfo) SpecVersion() string {
	val, _ := d.ReadAttribute(DeviceInfoAttrSpecVersion)
	if v, ok := val.(string); ok {
		return v
	}
	return "1.0"
}

// Location returns the installation location.
func (d *DeviceInfo) Location() (string, bool) {
	val, err := d.ReadAttribute(DeviceInfoAttrLocation)
	if err != nil || val == nil {
		return "", false
	}
	if v, ok := val.(string); ok {
		return v, true
	}
	return "", false
}

// Label returns the user-assigned name.
func (d *DeviceInfo) Label() (string, bool) {
	val, err := d.ReadAttribute(DeviceInfoAttrLabel)
	if err != nil || val == nil {
		return "", false
	}
	if v, ok := val.(string); ok {
		return v, true
	}
	return "", false
}

// SetDeviceID sets the globally unique device identifier.
func (d *DeviceInfo) SetDeviceID(deviceId string) error {
	attr, err := d.GetAttribute(DeviceInfoAttrDeviceID)
	if err != nil {
		return err
	}
	return attr.SetValueInternal(deviceId)
}

// SetVendorName sets the manufacturer name.
func (d *DeviceInfo) SetVendorName(vendorName string) error {
	attr, err := d.GetAttribute(DeviceInfoAttrVendorName)
	if err != nil {
		return err
	}
	return attr.SetValueInternal(vendorName)
}

// SetProductName sets the product name.
func (d *DeviceInfo) SetProductName(productName string) error {
	attr, err := d.GetAttribute(DeviceInfoAttrProductName)
	if err != nil {
		return err
	}
	return attr.SetValueInternal(productName)
}

// SetSerialNumber sets the device serial number.
func (d *DeviceInfo) SetSerialNumber(serialNumber string) error {
	attr, err := d.GetAttribute(DeviceInfoAttrSerialNumber)
	if err != nil {
		return err
	}
	return attr.SetValueInternal(serialNumber)
}

// SetVendorID sets the iANA Private Enterprise Number.
func (d *DeviceInfo) SetVendorID(vendorId uint32) error {
	attr, err := d.GetAttribute(DeviceInfoAttrVendorID)
	if err != nil {
		return err
	}
	return attr.SetValueInternal(vendorId)
}

// ClearVendorID clears the iANA Private Enterprise Number.
func (d *DeviceInfo) ClearVendorID() error {
	attr, err := d.GetAttribute(DeviceInfoAttrVendorID)
	if err != nil {
		return err
	}
	return attr.SetValueInternal(nil)
}

// SetVendorIDPtr sets or clears the iANA Private Enterprise Number from a pointer.
func (d *DeviceInfo) SetVendorIDPtr(v *uint32) error {
	if v == nil {
		return d.ClearVendorID()
	}
	return d.SetVendorID(*v)
}

// SetProductID sets the vendor's product ID.
func (d *DeviceInfo) SetProductID(productId uint16) error {
	attr, err := d.GetAttribute(DeviceInfoAttrProductID)
	if err != nil {
		return err
	}
	return attr.SetValueInternal(productId)
}

// ClearProductID clears the vendor's product ID.
func (d *DeviceInfo) ClearProductID() error {
	attr, err := d.GetAttribute(DeviceInfoAttrProductID)
	if err != nil {
		return err
	}
	return attr.SetValueInternal(nil)
}

// SetProductIDPtr sets or clears the vendor's product ID from a pointer.
func (d *DeviceInfo) SetProductIDPtr(v *uint16) error {
	if v == nil {
		return d.ClearProductID()
	}
	return d.SetProductID(*v)
}

// SetSoftwareVersion sets the firmware/software version.
func (d *DeviceInfo) SetSoftwareVersion(softwareVersion string) error {
	attr, err := d.GetAttribute(DeviceInfoAttrSoftwareVersion)
	if err != nil {
		return err
	}
	return attr.SetValueInternal(softwareVersion)
}

// SetHardwareVersion sets the hardware revision.
func (d *DeviceInfo) SetHardwareVersion(hardwareVersion string) error {
	attr, err := d.GetAttribute(DeviceInfoAttrHardwareVersion)
	if err != nil {
		return err
	}
	return attr.SetValueInternal(hardwareVersion)
}

// ClearHardwareVersion clears the hardware revision.
func (d *DeviceInfo) ClearHardwareVersion() error {
	attr, err := d.GetAttribute(DeviceInfoAttrHardwareVersion)
	if err != nil {
		return err
	}
	return attr.SetValueInternal(nil)
}

// SetHardwareVersionPtr sets or clears the hardware revision from a pointer.
func (d *DeviceInfo) SetHardwareVersionPtr(v *string) error {
	if v == nil {
		return d.ClearHardwareVersion()
	}
	return d.SetHardwareVersion(*v)
}

// SetSpecVersion sets the mASH specification version.
func (d *DeviceInfo) SetSpecVersion(specVersion string) error {
	attr, err := d.GetAttribute(DeviceInfoAttrSpecVersion)
	if err != nil {
		return err
	}
	return attr.SetValueInternal(specVersion)
}

// SetLocation sets the installation location.
func (d *DeviceInfo) SetLocation(location string) error {
	attr, err := d.GetAttribute(DeviceInfoAttrLocation)
	if err != nil {
		return err
	}
	return attr.SetValueInternal(location)
}

// ClearLocation clears the installation location.
func (d *DeviceInfo) ClearLocation() error {
	attr, err := d.GetAttribute(DeviceInfoAttrLocation)
	if err != nil {
		return err
	}
	return attr.SetValueInternal(nil)
}

// SetLocationPtr sets or clears the installation location from a pointer.
func (d *DeviceInfo) SetLocationPtr(v *string) error {
	if v == nil {
		return d.ClearLocation()
	}
	return d.SetLocation(*v)
}

// SetLabel sets the user-assigned name.
func (d *DeviceInfo) SetLabel(label string) error {
	attr, err := d.GetAttribute(DeviceInfoAttrLabel)
	if err != nil {
		return err
	}
	return attr.SetValueInternal(label)
}

// ClearLabel clears the user-assigned name.
func (d *DeviceInfo) ClearLabel() error {
	attr, err := d.GetAttribute(DeviceInfoAttrLabel)
	if err != nil {
		return err
	}
	return attr.SetValueInternal(nil)
}

// SetLabelPtr sets or clears the user-assigned name from a pointer.
func (d *DeviceInfo) SetLabelPtr(v *string) error {
	if v == nil {
		return d.ClearLabel()
	}
	return d.SetLabel(*v)
}

// DeviceInfo command IDs.
const (
	DeviceInfoCmdRemoveZone uint8 = 16
)

// RemoveZoneRequest represents the removeZone command parameters.
type RemoveZoneRequest struct {
	ZoneID string
}

// RemoveZoneResponse represents the removeZone command response.
type RemoveZoneResponse struct {
	Removed bool
}

// addCommands adds the DeviceInfo commands.
func (d *DeviceInfo) addCommands() {
	d.AddCommand(model.NewCommand(&model.CommandMetadata{
		ID:          DeviceInfoCmdRemoveZone,
		Name:        "removeZone",
		Description: "Remove a zone from this device",
		Parameters: []model.ParameterMetadata{
			{Name: "zoneId", Type: model.DataTypeString, Required: true},
		},
	}, d.handleRemoveZone))

}

func (d *DeviceInfo) handleRemoveZone(ctx context.Context, params map[string]any) (map[string]any, error) {
	if d.onRemoveZone == nil {
		return map[string]any{"success": false}, nil
	}

	req := RemoveZoneRequest{}
	if raw, exists := params["zoneId"]; exists {
		if v, ok := raw.(string); ok {
			req.ZoneID = v
		}
	}

	resp, err := d.onRemoveZone(ctx, req)
	if err != nil {
		return nil, err
	}

	result := make(map[string]any)
	result["removed"] = resp.Removed
	return result, nil
}

// OnRemoveZone sets the handler for removeZone command.
func (d *DeviceInfo) OnRemoveZone(handler func(ctx context.Context, req RemoveZoneRequest) (RemoveZoneResponse, error)) {
	d.onRemoveZone = handler
}
