# PICS (Protocol Implementation Conformance Statement)
# Zone Management Capabilities
#
# This file describes the multi-zone management capabilities for test filtering.
# Zone management defines how multiple controllers interact with a single device,
# including priority-based resolution and force removal.

# Device Identification
device:
  vendor: "Reference"
  product: "Zone Management PICS"
  model: "N/A"
  version: "1.0.0"

# PICS Items
items:
  # ==========================================================================
  # Zone Support
  # ==========================================================================

  MASH.S.ZONE: true               # Multi-zone support
  MASH.S.ZONE.MAX: 5              # Maximum zones per device (hardcoded)

  # ==========================================================================
  # Zone Types Supported
  # ==========================================================================

  MASH.S.ZONE.GRID_OP: true       # GRID_OPERATOR zone (priority 1, highest)
  MASH.S.ZONE.BLDG_MGR: true      # BUILDING_MANAGER zone (priority 2)
  MASH.S.ZONE.HOME_MGR: true      # HOME_MANAGER zone (priority 3)
  MASH.S.ZONE.USER_APP: true      # USER_APP zone (priority 4, lowest)

  # ==========================================================================
  # Zone Operations
  # ==========================================================================

  MASH.S.ZONE.ADD: true           # AddZone operation
  MASH.S.ZONE.REMOVE: true        # RemoveZone operation
  MASH.S.ZONE.FORCE_REMOVE: true  # ForceRemoveZone operation

  # ==========================================================================
  # Connection State Tracking
  # ==========================================================================

  MASH.S.ZONE.CONNECT: true       # SetConnected/SetDisconnected
  MASH.S.ZONE.LAST_SEEN: true     # LastSeen timestamp tracking
  MASH.S.ZONE.COMM_TIME: true     # Commissioning timestamp

  # ==========================================================================
  # Behavioral Capabilities
  # ==========================================================================

  # Priority-based resolution for setpoints
  MASH.S.ZONE.B_PRIORITY: true    # Highest priority zone wins for setpoints

  # Most restrictive wins for limits
  MASH.S.ZONE.B_RESTRICT: true    # Most restrictive limit wins

  # Force removal requires higher priority
  MASH.S.ZONE.B_FORCE_REMOVE: true # Priority enforcement on force remove

  # Per-zone session management
  MASH.S.ZONE.B_SESSION: true     # Separate session per zone

  # Bidirectional communication
  MASH.S.ZONE.B_BIDIR_COMM: true  # Device can send to controller

  # ==========================================================================
  # Failsafe Behavior
  # ==========================================================================

  MASH.S.ZONE.FAILSAFE: true      # Per-zone failsafe tracking
  MASH.S.ZONE.FAILSAFE_DUR: true  # Configurable failsafe duration

# =============================================================================
# Zone Type Priority Hierarchy
# =============================================================================
# 1. GRID_OPERATOR (highest priority)
#    - Grid emergency response, regulatory requirements
#    - Can override all other zones
#
# 2. BUILDING_MANAGER
#    - Building-level energy management
#    - Can override HOME_MANAGER and USER_APP
#
# 3. HOME_MANAGER
#    - Home energy management system
#    - Can override USER_APP
#
# 4. USER_APP (lowest priority)
#    - User-facing applications
#    - No override capability

# =============================================================================
# Multi-Zone Resolution Rules
# =============================================================================
#
# LIMITS (most restrictive wins):
# - Consumption limits: smaller value = more restrictive
# - Production limits: closer to zero = more restrictive
# - Mixed signs: positive (consumption) takes precedence (safety)
#
# SETPOINTS (highest priority wins):
# - Zone with lowest priority number wins
# - GRID_OPERATOR (1) > BUILDING_MANAGER (2) > HOME_MANAGER (3) > USER_APP (4)
#
# FORCE REMOVAL:
# - Requester must have higher priority than target
# - GRID_OPERATOR can force remove any zone
# - USER_APP cannot force remove any zone

# =============================================================================
# Test Case to PICS Mapping
# =============================================================================
#
# TC-ZONE-001 (Single zone sets limit):
#   - MASH.S.ZONE: true
#   - MASH.S.CTRL.C01.Rsp: true
#
# TC-ZONE-002 (Two zones, lower value wins):
#   - MASH.S.ZONE.B_RESTRICT: true
#
# TC-ZONE-003 (Production limit closer to zero wins):
#   - MASH.S.ZONE.B_RESTRICT: true
#
# TC-ZONE-004 (Mixed consumption/production limits):
#   - MASH.S.ZONE.B_RESTRICT: true
#
# TC-ZONE-005 (Limit with duration expires):
#   - MASH.S.ZONE: true
#   - MASH.S.CTRL.B_DURATION: true
#
# TC-ZONE-006 (Higher priority zone's setpoint wins):
#   - MASH.S.ZONE.B_PRIORITY: true
#
# TC-ZONE-007 (Zone disconnect affects resolution):
#   - MASH.S.ZONE.CONNECT: true
#
# TC-ZONE-008 (Force remove lower priority zone):
#   - MASH.S.ZONE.B_FORCE_REMOVE: true
#
# TC-ZONE-009 (Cannot force remove higher priority):
#   - MASH.S.ZONE.B_FORCE_REMOVE: true
#
# TC-ZONE-010 (Per-phase limit resolution):
#   - MASH.S.ZONE.B_RESTRICT: true
#   - MASH.S.CTRL.F09: true
#
# TC-ZONE-011 (Zone reconnect restores values):
#   - MASH.S.ZONE.CONNECT: true
#   - MASH.S.ZONE.LAST_SEEN: true
#
# TC-ZONE-012 (Maximum 5 zones enforcement):
#   - MASH.S.ZONE.MAX: 5
#
# TC-ZONE-013 (All zones clear limit):
#   - MASH.S.ZONE: true
#   - MASH.S.CTRL.C02.Rsp: true
