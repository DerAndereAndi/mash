# PICS (Protocol Implementation Conformance Statement)
# Common Protocol Capabilities
#
# This file describes protocol-level capabilities that are not
# specific to any device type. Device profiles (like ev-charger.yaml)
# describe device-specific features; this file covers the protocol layer.

# Device Identification
device:
  vendor: "Reference"
  product: "Protocol Common"
  model: "N/A"
  version: "1.0.0"

# PICS Items
items:
  # Protocol declarations (this file has both server and controller items)
  MASH.S: 1
  MASH.C: 1

  # ==========================================================================
  # Certificate Management (Device-Side)
  # ==========================================================================

  MASH.S.CERT.EXCHANGE: true          # Device supports cert exchange after PASE
  MASH.S.CERT.DEVICE_ID_FROM_CN: true # Device extracts device ID from cert CommonName
  MASH.S.CERT.RENEWAL: true           # Device supports certificate renewal
  MASH.S.CERT.IN_SESSION_RENEWAL: true # Renewal without TLS reconnection
  MASH.S.CERT.EXPIRY_HANDLING: true   # Proper handling of expired certificates
  MASH.S.CERT.GRACE_PERIOD: 7         # Days to accept connections after expiry
  MASH.S.EVENT.CERT_EXPIRING: true    # Sends notification when cert near expiry

  # ==========================================================================
  # Certificate Management (Controller-Side)
  # ==========================================================================

  MASH.C.CERT.ZONE_CA: true           # Controller has Zone CA for signing
  MASH.C.CERT.RENEWAL_INITIATE: true  # Controller can initiate renewal
  MASH.C.CERT.AUTO_RENEWAL: false     # Automatic renewal (optional)

  # ==========================================================================
  # Pairing Request Mechanism (DEC-042)
  # ==========================================================================

  MASH.S.DISC.PAIRING_REQUEST: true    # Device listens for pairing requests (_mashp._udp)
  MASH.S.COMM.PAIRING_REQUEST: true    # Device opens window on matching pairing request
  MASH.S.DISC.PAIRING_DISCRIMINATOR: true  # Device matches by discriminator

  # ==========================================================================
  # Controller Pairing Request
  # ==========================================================================

  MASH.C.DISC.PAIRING_REQUEST: true    # Controller can announce pairing requests

# =============================================================================
# Test Case to PICS Mapping
# =============================================================================
#
# TC-CERT-RENEW-1 (Normal Renewal):
#   - MASH.S.CERT.RENEWAL: true
#   - MASH.C.CERT.ZONE_CA: true
#
# TC-CERT-RENEW-2 (Session Continuity):
#   - MASH.S.CERT.IN_SESSION_RENEWAL: true
#
# TC-CERT-RENEW-3 (Expiry Warning):
#   - MASH.S.EVENT.CERT_EXPIRING: true
#
# TC-CERT-RENEW-4 (Expired Certificate):
#   - MASH.S.CERT.EXPIRY_HANDLING: true
#   - MASH.S.CERT.GRACE_PERIOD: 0
#
# TC-CERT-RENEW-5 (Grace Period):
#   - MASH.S.CERT.GRACE_PERIOD: > 0
#
# =============================================================================
# Pairing Request Tests (DEC-042)
# =============================================================================
#
# TC-PAIR-001 (Device Opens Window on Pairing Request):
#   - MASH.S.DISC.PAIRING_REQUEST: true
#   - MASH.S.COMM.PAIRING_REQUEST: true
#
# TC-PAIR-002 (Device Ignores Mismatched Discriminator):
#   - MASH.S.DISC.PAIRING_REQUEST: true
#   - MASH.S.DISC.PAIRING_DISCRIMINATOR: true
#
# TC-PAIR-003 (Rate Limiting - Window Already Open):
#   - MASH.S.DISC.PAIRING_REQUEST: true
#   - MASH.S.COMM.PAIRING_REQUEST: true
#
# TC-PAIR-004 (Deferred Commissioning Flow):
#   - MASH.S.DISC.PAIRING_REQUEST: true
#   - MASH.S.COMM.PAIRING_REQUEST: true
#   - MASH.S.TRANS.PASE: true
#
# TC-PAIR-005 (Commissioned Device Ignores Pairing Requests):
#   - MASH.S.DISC.PAIRING_REQUEST: true
#   - MASH.S.ZONE.MAX: 2
#
# =============================================================================
# Commissioning Certificate Exchange Tests
# =============================================================================
#
# TC-COMM-002 (Certificate Exchange After PASE):
#   - MASH.S.CERT.EXCHANGE: true
#   - MASH.S.CERT.DEVICE_ID_FROM_CN: true
#   - MASH.C.CERT.ZONE_CA: true
#
# TC-COMM-003 (Device ID Consistency):
#   - MASH.S.CERT.DEVICE_ID_FROM_CN: true
#   - MASH.S.DISC.OP: true
#
# TC-COMM-004 (Multi-Zone Different Device IDs):
#   - MASH.S.CERT.EXCHANGE: true
#   - MASH.S.ZONE.MAX: 2
