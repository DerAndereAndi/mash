# PICS (Protocol Implementation Conformance Statement)
# ChargingSession Feature Capabilities
#
# This file describes the ChargingSession feature capabilities for test filtering.
# The ChargingSession feature manages EV charging sessions, including V2G/V2H
# bidirectional charging capabilities.

# Device Identification
device:
  vendor: "Reference"
  product: "ChargingSession Feature PICS"
  model: "N/A"
  version: "1.0.0"

# PICS Items
items:
  # Protocol declaration
  MASH.S: 1

  # Endpoint declaration
  MASH.S.E01: EV_CHARGER           # Reference endpoint for charging session

  # ==========================================================================
  # Feature Presence
  # ==========================================================================

  MASH.S.E01.CHRG: true            # ChargingSession feature present

  # ==========================================================================
  # Session State Attributes (Mandatory)
  # ==========================================================================

  MASH.S.E01.CHRG.A01: true        # state (ChargingState enum)
  MASH.S.E01.CHRG.A03: true        # sessionStartTime (uint64, nullable)
  MASH.S.E01.CHRG.A04: true        # sessionEndTime (uint64, nullable)

  # ==========================================================================
  # Session Energy Attributes
  # ==========================================================================

  MASH.S.E01.CHRG.A0A: true        # sessionEnergyCharged (uint64, mWh)
  MASH.S.E01.CHRG.A0B: false       # sessionEnergyDischarged (uint64, mWh, requires V2X)

  # ==========================================================================
  # EV Identification Attributes (Optional, Nullable)
  # ==========================================================================

  MASH.S.E01.CHRG.A14: true        # evIdentifications (array of {type, value})

  # ==========================================================================
  # EV Battery State Attributes (Optional, Nullable)
  # ==========================================================================

  MASH.S.E01.CHRG.A1E: true        # evStateOfCharge (uint8, 0-100%)
  MASH.S.E01.CHRG.A1F: true        # evBatteryCapacity (uint64, mWh)

  # ==========================================================================
  # EV Energy Demand Attributes (Nullable)
  # ==========================================================================

  MASH.S.E01.CHRG.A28: true        # evDemandMode (EVDemandMode enum)
  MASH.S.E01.CHRG.A29: true        # evMinEnergyRequest (int64, mWh, negative=can discharge)
  MASH.S.E01.CHRG.A2A: true        # evMaxEnergyRequest (int64, mWh)
  MASH.S.E01.CHRG.A2B: true        # evTargetEnergyRequest (int64, mWh)
  MASH.S.E01.CHRG.A2C: true        # evDepartureTime (uint64, timestamp)

  # ==========================================================================
  # V2G Discharge Constraint Attributes (Requires V2X + DYNAMIC_BIDIRECTIONAL)
  # ==========================================================================

  MASH.S.E01.CHRG.A32: false       # evMinDischargingRequest (int64, mWh, must be < 0)
  MASH.S.E01.CHRG.A33: false       # evMaxDischargingRequest (int64, mWh, must be >= 0)
  MASH.S.E01.CHRG.A34: false       # evDischargeBelowTargetPermitted (bool)

  # ==========================================================================
  # Estimated Time Attributes (Read-Only, Nullable, seconds)
  # ==========================================================================

  MASH.S.E01.CHRG.A3C: true        # estimatedTimeToMinSoC
  MASH.S.E01.CHRG.A3D: true        # estimatedTimeToTargetSoC
  MASH.S.E01.CHRG.A3E: true        # estimatedTimeToFullSoC

  # ==========================================================================
  # Charging Mode Attributes
  # ==========================================================================

  MASH.S.E01.CHRG.A46: true        # chargingMode (ChargingMode enum)
  MASH.S.E01.CHRG.A47: true        # supportedChargingModes (array)
  MASH.S.E01.CHRG.A48: true        # surplusThreshold (int64, mW, nullable)

  # ==========================================================================
  # Start/Stop Delay Attributes (seconds)
  # ==========================================================================

  MASH.S.E01.CHRG.A50: true        # startDelay (uint32, default 0)
  MASH.S.E01.CHRG.A51: true        # stopDelay (uint32, default 0)

  # ==========================================================================
  # Commands
  # ==========================================================================

  MASH.S.E01.CHRG.C01.Rsp: true    # SetChargingMode

  # ==========================================================================
  # V2G Capability Flag
  # ==========================================================================

  MASH.S.E01.CHRG.A_V2G: false     # V2G attributes present (requires V2X flag)

  # ==========================================================================
  # Behavioral Capabilities
  # ==========================================================================

  MASH.S.E01.CHRG.B_DISCHARGE: true  # CanDischarge capability check
  MASH.S.E01.CHRG.B_LIFECYCLE: true  # StartSession/EndSession methods
  MASH.S.E01.CHRG.B_MODE: true    # SupportsMode validation
  MASH.S.E01.CHRG.B_HELPERS: true  # State helper methods
