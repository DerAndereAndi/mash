# Test Case: PASE Commissioning
# Verifies password-authenticated session establishment using SPAKE2+

id: TC-COMM-001
name: PASE Commissioning Handshake
description: |
  Verifies that a controller can establish a secure session
  with a device using PASE (Password-Authenticated Session Establishment).

  This test performs the full SPAKE2+ handshake:
  1. Client sends PASERequest with public value (pA)
  2. Server responds with PASEResponse containing its public value (pB)
  3. Client sends PASEConfirm with its confirmation MAC
  4. Server sends PASEComplete with its confirmation MAC

  Upon success, both parties derive a shared 32-byte session key.

pics_requirements:
  - D.COMM.SC     # Device supports secure connection
  - D.COMM.PASE   # Device supports PASE commissioning

preconditions:
  - device_in_commissioning_mode: true
  - tls_connection_established: true

steps:
  - name: Perform PASE commissioning
    action: commission
    params:
      setup_code: "12345678"
      endpoint: 0
    expect:
      session_established: true
      key_length: 32
      key_not_zero: true

postconditions:
  - session_active: true
  - commissioning_complete: true

timeout: "10s"
tags:
  - base-protocol
  - commissioning
  - PASE
  - security
  - SPAKE2+

