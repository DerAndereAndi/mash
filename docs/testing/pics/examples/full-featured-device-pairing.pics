# MASH PICS File - Full-Featured Device (Pairing/Connection)
# Device: Advanced Energy Device - All Optional Features
# Version: 1.0
# Date: 2025-01-25
#
# This PICS file represents a device with all optional pairing/connection
# capabilities enabled. Suitable for high-end devices (Linux-based, >1MB RAM).
# Includes attestation, admin delegation, persistent failsafe, QR code, etc.

#=============================================================================
# PROTOCOL SUPPORT
#=============================================================================
MASH.S=1
MASH.S.VERSION=1

#=============================================================================
# TRANSPORT LAYER
#=============================================================================

# Protocol Stack
MASH.S.TRANS=1
MASH.S.TRANS.IPV6=1
MASH.S.TRANS.TLS13=1
MASH.S.TRANS.PORT=8443

# TLS Cipher Suites (all supported)
MASH.S.TRANS.TLS_AES_128_GCM=1
MASH.S.TRANS.TLS_AES_256_GCM=1
MASH.S.TRANS.TLS_CHACHA20=1

# Key Exchange (all supported)
MASH.S.TRANS.ECDHE_P256=1
MASH.S.TRANS.ECDHE_X25519=1

# Framing
MASH.S.TRANS.MAX_MSG_SIZE=65536
MASH.S.TRANS.LENGTH_PREFIX=1

# Keep-Alive
MASH.S.TRANS.PING_INTERVAL=30
MASH.S.TRANS.PONG_TIMEOUT=5
MASH.S.TRANS.MAX_MISSED_PONGS=3
MASH.S.TRANS.DETECTION_DELAY_MAX=95

#=============================================================================
# COMMISSIONING
#=============================================================================

# PASE Support
MASH.S.COMM=1
MASH.S.COMM.PASE=1
MASH.S.COMM.PASE_GROUP="P-256"
MASH.S.COMM.PASE_HASH="SHA-256"
MASH.S.COMM.PASE_KDF="HKDF-SHA256"
MASH.S.COMM.PASE_MAC="HMAC-SHA256"

# Commissioning Window
MASH.S.COMM.WINDOW_DURATION=120
MASH.S.COMM.SETUP_CODE_BITS=27
MASH.S.COMM.DISCRIMINATOR_BITS=12

# Timeouts
MASH.S.COMM.PASE_TIMEOUT=30
MASH.S.COMM.CSR_TIMEOUT=10
MASH.S.COMM.CERT_TIMEOUT=30

# Attestation (FULL SUPPORT)
MASH.S.COMM.ATTESTATION=1
MASH.S.COMM.ATTESTATION_CERT=1

#=============================================================================
# CERTIFICATE MANAGEMENT
#=============================================================================

MASH.S.CERT=1
MASH.S.CERT.X509V3=1
MASH.S.CERT.ECDSA_P256=1

# Storage (DEC-043: one zone per type, max 2)
MASH.S.CERT.MAX_ZONES=2
MASH.S.CERT.PERSISTENT=1

# Lifecycle (with grace period)
MASH.S.CERT.OP_VALIDITY=365
MASH.S.CERT.RENEWAL_WINDOW=30
MASH.S.CERT.IN_SESSION_RENEWAL=1
MASH.S.CERT.GRACE_PERIOD=7

#=============================================================================
# ZONE MANAGEMENT (DEC-043: one zone per type)
#=============================================================================

MASH.S.ZONE=1
MASH.S.ZONE.MAX_ZONES=2

# Zone Types (accepts both, but only one of each type)
MASH.S.ZONE.GRID=1
MASH.S.ZONE.LOCAL=1

# Zone Operations
MASH.S.ZONE.ADD=1
MASH.S.ZONE.REMOVE=1
MASH.S.ZONE.LIST=1

# Admin Delegation (FULL SUPPORT)
MASH.S.ZONE.ADMIN_DELEGATION=1
MASH.S.ZONE.TEMP_TOKEN_DURATION=300

#=============================================================================
# CONNECTION LIFECYCLE
#=============================================================================

MASH.S.CONN=1
MASH.S.CONN.GRACEFUL_CLOSE=1
MASH.S.CONN.CLOSE_TIMEOUT=5

#=============================================================================
# FAILSAFE BEHAVIOR
#=============================================================================

MASH.S.FAILSAFE=1
MASH.S.FAILSAFE.DURATION_MIN=7200
MASH.S.FAILSAFE.DURATION_MAX=86400
MASH.S.FAILSAFE.DURATION_DEFAULT=14400

# Failsafe Limits (bidirectional device)
MASH.S.FAILSAFE.CONSUMPTION_LIMIT=1
MASH.S.FAILSAFE.PRODUCTION_LIMIT=1
MASH.S.FAILSAFE.LIMIT_CONFIGURABLE=1

# Behavior (FULL - persistent timer, grace period)
MASH.S.FAILSAFE.TIMER_PERSISTENT=1
MASH.S.FAILSAFE.TIMER_ACCURACY="1%"
MASH.S.FAILSAFE.GRACE_PERIOD=1
MASH.S.FAILSAFE.GRACE_DURATION=300
MASH.S.FAILSAFE.RECONNECT_WINS=1

#=============================================================================
# SUBSCRIPTION HANDLING
#=============================================================================

MASH.S.SUB=1
MASH.S.SUB.MAX_SUBSCRIPTIONS=50
MASH.S.SUB.MAX_ATTRS_PER_SUB=100

# Intervals
MASH.S.SUB.MIN_INTERVAL_MIN=0
MASH.S.SUB.MIN_INTERVAL_MAX=3600
MASH.S.SUB.MAX_INTERVAL_MIN=1
MASH.S.SUB.MAX_INTERVAL_MAX=86400

# Behavior (all optimizations enabled)
MASH.S.SUB.COALESCE="last_value"
MASH.S.SUB.BOUNCE_BACK=1
MASH.S.SUB.HEARTBEAT_CONTENT="full"
MASH.S.SUB.PRIMING=1
MASH.S.SUB.DELTA_ONLY=1
MASH.S.SUB.INTERVAL_AUTOCORRECT=1

#=============================================================================
# DURATION TIMERS
#=============================================================================

MASH.S.DURATION=1
MASH.S.DURATION.MAX=86400
MASH.S.DURATION.START_ON="receipt"
MASH.S.DURATION.EXPIRY_ACTION="clear"
MASH.S.DURATION.PERSIST_RECONNECT=0
MASH.S.DURATION.ACCURACY="1%"

#=============================================================================
# DISCOVERY
#=============================================================================

MASH.S.DISC=1
MASH.S.DISC.MDNS=1
MASH.S.DISC.SERVICE_TYPE="_mash._tcp"

# Pre-Commissioning
MASH.S.DISC.PRE_COMM=1
MASH.S.DISC.TXT_D=1
MASH.S.DISC.TXT_VP=1
MASH.S.DISC.TXT_CM=1
MASH.S.DISC.TXT_DT=1

# Post-Commissioning
MASH.S.DISC.POST_COMM=1
MASH.S.DISC.TXT_DI=1
MASH.S.DISC.TXT_FW=1
MASH.S.DISC.TXT_EP=1
MASH.S.DISC.TXT_FM=1

# QR Code (FULL SUPPORT)
MASH.S.DISC.QR=1
MASH.S.DISC.QR_FORMAT=1
MASH.S.DISC.MANUAL_ENTRY=1

# Pairing Request Discovery (DEC-042 - FULL SUPPORT)
MASH.S.DISC.PAIRING_REQUEST=1
MASH.S.DISC.TXT_D_PAIRING=1
MASH.S.DISC.TXT_ZI=1
MASH.S.DISC.TXT_ZN=1
